from web.database.models import User, Animal, Video, Analysis


def menu_items(request):
    """
    –ö–æ–Ω—Ç–µ–∫—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.
    –î–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é 'menu_items' –≤–æ –≤—Å–µ —à–∞–±–ª–æ–Ω—ã.
    """
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - —Ç–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω–∞—è –∏ –≤—Ö–æ–¥
    if not request.user.is_authenticated:
        items = [
            {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
            {'name': '–í–æ–π—Ç–∏', 'url': '/login/', 'icon': 'üîê'},
        ]
        return {'menu_items': items}
    
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø–æ–ª–Ω–æ–µ –º–µ–Ω—é
    items = [
        {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
        {'name': '–ú–æ–∏ –ª–æ—à–∞–¥–∏', 'url': '/animals/', 'icon': 'üê¥'},
        {'name': '–ê–Ω–∞–ª–∏–∑ –ø–æ—Ö–æ–¥–∫–∏', 'url': '/video-upload/', 'icon': 'üìπ'},
        {'name': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã', 'url': '/analysis/results/', 'icon': 'üìä'},
        {'name': '–†–∞—Ü–∏–æ–Ω', 'url': '/ration/', 'icon': 'ü•ó'},
    ]
    
    # –î–ª—è –∞–¥–º–∏–Ω–æ–≤ –¥–æ–±–∞–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    try:
        custom_user = User.objects.get(login=request.user.username)
        if custom_user.role_id in ['admin', 'superadmin']:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    except User.DoesNotExist:
        if hasattr(request.user, 'is_staff') and request.user.is_staff:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    
    return {'menu_items': items}1~def menu_items(request):
    """
    –ö–æ–Ω—Ç–µ–∫—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.
    –î–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é 'menu_items' –≤–æ –≤—Å–µ —à–∞–±–ª–æ–Ω—ã.
    """
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - —Ç–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω–∞—è –∏ –≤—Ö–æ–¥
    if not request.user.is_authenticated:
        items = [
            {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
            {'name': '–í–æ–π—Ç–∏', 'url': '/login/', 'icon': 'üîê'},
        ]
        return {'menu_items': items}
    
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø–æ–ª–Ω–æ–µ –º–µ–Ω—é
    items = [
        {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
        {'name': '–ú–æ–∏ –ª–æ—à–∞–¥–∏', 'url': '/animals/', 'icon': 'üê¥'},
        {'name': '–ê–Ω–∞–ª–∏–∑ –ø–æ—Ö–æ–¥–∫–∏', 'url': '/video-upload/', 'icon': 'üìπ'},
        {'name': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã', 'url': '/analysis/results/', 'icon': 'üìä'},
        {'name': '–†–∞—Ü–∏–æ–Ω', 'url': '/ration/', 'icon': 'ü•ó'},
    ]
    
    # –î–ª—è –∞–¥–º–∏–Ω–æ–≤ –¥–æ–±–∞–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    try:
        custom_user = User.objects.get(login=request.user.username)
        if custom_user.role_id in ['admin', 'superadmin']:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    except User.DoesNotExist:
        if hasattr(request.user, 'is_staff') and request.user.is_staff:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    
    return {'menu_items': items}1~def menu_items(request):
    """
    –ö–æ–Ω—Ç–µ–∫—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.
    –î–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é 'menu_items' –≤–æ –≤—Å–µ —à–∞–±–ª–æ–Ω—ã.
    """
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - —Ç–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω–∞—è –∏ –≤—Ö–æ–¥
    if not request.user.is_authenticated:
        items = [
            {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
            {'name': '–í–æ–π—Ç–∏', 'url': '/login/', 'icon': 'üîê'},
        ]
        return {'menu_items': items}
    
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø–æ–ª–Ω–æ–µ –º–µ–Ω—é
    items = [
        {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
        {'name': '–ú–æ–∏ –ª–æ—à–∞–¥–∏', 'url': '/animals/', 'icon': 'üê¥'},
        {'name': '–ê–Ω–∞–ª–∏–∑ –ø–æ—Ö–æ–¥–∫–∏', 'url': '/video-upload/', 'icon': 'üìπ'},
        {'name': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã', 'url': '/analysis/results/', 'icon': 'üìä'},
        {'name': '–†–∞—Ü–∏–æ–Ω', 'url': '/ration/', 'icon': 'ü•ó'},
    ]
    
    # –î–ª—è –∞–¥–º–∏–Ω–æ–≤ –¥–æ–±–∞–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    try:
        custom_user = User.objects.get(login=request.user.username)
        if custom_user.role_id in ['admin', 'superadmin']:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    except User.DoesNotExist:
        if hasattr(request.user, 'is_staff') and request.user.is_staff:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    
    return {'menu_items': items}1~def menu_items(request):
    """
    –ö–æ–Ω—Ç–µ–∫—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–ª—è –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.
    –î–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é 'menu_items' –≤–æ –≤—Å–µ —à–∞–±–ª–æ–Ω—ã.
    """
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - —Ç–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω–∞—è –∏ –≤—Ö–æ–¥
    if not request.user.is_authenticated:
        items = [
            {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
            {'name': '–í–æ–π—Ç–∏', 'url': '/login/', 'icon': 'üîê'},
        ]
        return {'menu_items': items}
    
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –ø–æ–ª–Ω–æ–µ –º–µ–Ω—é
    items = [
        {'name': '–ì–ª–∞–≤–Ω–∞—è', 'url': '/', 'icon': 'üè†'},
        {'name': '–ú–æ–∏ –ª–æ—à–∞–¥–∏', 'url': '/animals/', 'icon': 'üê¥'},
        {'name': '–ê–Ω–∞–ª–∏–∑ –ø–æ—Ö–æ–¥–∫–∏', 'url': '/video-upload/', 'icon': 'üìπ'},
        {'name': '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã', 'url': '/analysis/results/', 'icon': 'üìä'},
        {'name': '–†–∞—Ü–∏–æ–Ω', 'url': '/ration/', 'icon': 'ü•ó'},
    ]
    
    # –î–ª—è –∞–¥–º–∏–Ω–æ–≤ –¥–æ–±–∞–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    try:
        custom_user = User.objects.get(login=request.user.username)
        if custom_user.role_id in ['admin', 'superadmin']:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    except User.DoesNotExist:
        if hasattr(request.user, 'is_staff') and request.user.is_staff:
            items.append({'name': '–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è', 'url': '/dashboard/', 'icon': 'üõ°Ô∏è'})
    
    return {'menu_items': items}



def user_role(request):
    """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —à–∞–±–ª–æ–Ω–∞"""
    if not request.user.is_authenticated:
        return {'user_role': 'guest'}
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º Django –∞–¥–º–∏–Ω–∞
    if hasattr(request.user, 'is_staff') and request.user.is_staff:
        return {'user_role': 'admin'}
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    try:
        custom_user = User.objects.get(login=request.user.username)
        if custom_user.role_id in ['admin', 'superadmin']:
            return {'user_role': 'admin'}
    except:
        pass
    
    return {'user_role': 'user'}
