{% extends 'frontend/base.html' %}

{% block title %}–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Ü–∏–æ–Ω–æ–≤ - HorseAI{% endblock %}

{% block extra_css %}
<style>
    .history-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .page-header {
        margin-bottom: 40px;
        text-align: center;
    }

    .page-title {
        font-size: 36px;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
    }

    .page-subtitle {
        color: var(--text-secondary);
        font-size: 18px;
        max-width: 800px;
        margin: 0 auto;
        line-height: 1.6;
    }

    .actions-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding: 20px;
        background: var(--bg-card);
        border-radius: var(--radius);
        border: 1px solid var(--border);
    }

    .filters {
        display: flex;
        gap: 15px;
        align-items: center;
    }

    .filter-select {
        padding: 10px 15px;
        background: var(--bg-dark);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        color: var(--text-primary);
        font-size: 14px;
        min-width: 150px;
    }

    .filter-select:focus {
        outline: none;
        border-color: var(--accent);
    }

    .action-button {
        padding: 10px 20px;
        background: linear-gradient(135deg, var(--accent), var(--earth));
        color: white;
        border: none;
        border-radius: var(--radius);
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
    }

    .action-button:hover {
        background: linear-gradient(135deg, var(--accent-hover), var(--accent));
        transform: translateY(-2px);
    }

    .ration-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }

    .ration-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 25px;
        transition: all 0.3s ease;
        position: relative;
    }

    .ration-card:hover {
        border-color: var(--accent);
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg), var(--glow);
    }

    .ration-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid var(--border);
    }

    .ration-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 5px;
    }

    .ration-date {
        color: var(--text-tertiary);
        font-size: 13px;
    }

    .ration-badge {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
    }

    .badge-active {
        background: rgba(16, 185, 129, 0.15);
        color: #10b981;
        border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .badge-archived {
        background: rgba(148, 163, 184, 0.15);
        color: #94a3b8;
        border: 1px solid rgba(148, 163, 184, 0.3);
    }

    .ration-content {
        margin-bottom: 20px;
    }

    .ration-stats {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 20px;
    }

    .stat-item {
        display: flex;
        flex-direction: column;
    }

    .stat-label {
        color: var(--text-secondary);
        font-size: 12px;
        margin-bottom: 5px;
    }

    .stat-value {
        font-size: 18px;
        font-weight: 700;
        color: var(--text-primary);
    }

    .feed-summary {
        background: rgba(255, 255, 255, 0.05);
        border-radius: var(--radius);
        padding: 15px;
        margin-bottom: 20px;
    }

    .feed-item {
        display: flex;
        justify-content: space-between;
        padding: 5px 0;
        font-size: 14px;
    }

    .feed-name {
        color: var(--text-secondary);
    }

    .feed-amount {
        color: var(--text-primary);
        font-weight: 600;
    }

    .ration-cost {
        background: linear-gradient(135deg, rgba(217, 119, 6, 0.1), rgba(101, 163, 13, 0.1));
        border: 1px solid rgba(217, 119, 6, 0.3);
        border-radius: var(--radius);
        padding: 15px;
        margin-bottom: 20px;
    }

    .cost-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        font-size: 14px;
    }

    .cost-label {
        color: var(--text-secondary);
    }

    .cost-value {
        color: var(--text-primary);
        font-weight: 600;
    }

    .cost-total {
        border-top: 1px solid rgba(217, 119, 6, 0.5);
        padding-top: 10px;
        margin-top: 10px;
        font-weight: 700;
        color: var(--accent);
    }

    .ration-actions {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    .btn {
        padding: 8px 15px;
        border-radius: var(--radius);
        font-size: 13px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 5px;
        text-decoration: none;
        border: 1px solid var(--border);
        background: var(--bg-hover);
        color: var(--text-primary);
    }

    .btn:hover {
        border-color: var(--accent);
        background: var(--bg-card);
    }

    .btn-view {
        flex: 1;
        justify-content: center;
    }

    .btn-delete {
        background: rgba(239, 68, 68, 0.1);
        color: #fca5a5;
        border-color: rgba(239, 68, 68, 0.3);
    }

    .btn-delete:hover {
        background: rgba(239, 68, 68, 0.2);
        border-color: #ef4444;
        color: #f87171;
    }

    .empty-state {
        text-align: center;
        padding: 60px 20px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
    }

    .empty-icon {
        font-size: 64px;
        margin-bottom: 20px;
        opacity: 0.5;
    }

    .empty-title {
        font-size: 24px;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 10px;
    }

    .empty-text {
        color: var(--text-secondary);
        max-width: 600px;
        margin: 0 auto 30px;
        line-height: 1.6;
        font-size: 16px;
    }

    .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        margin-top: 40px;
    }

    .page-btn {
        padding: 10px 15px;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        color: var(--text-primary);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .page-btn:hover:not(:disabled) {
        border-color: var(--accent);
        background: var(--bg-hover);
    }

    .page-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .page-info {
        color: var(--text-secondary);
        font-size: 14px;
    }

    @media (max-width: 768px) {
        .ration-grid {
            grid-template-columns: 1fr;
        }
        
        .actions-bar {
            flex-direction: column;
            gap: 15px;
            align-items: stretch;
        }
        
        .filters {
            flex-wrap: wrap;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="history-container">
    <div class="page-header">
        <h1 class="page-title">
            <span>üìã</span>
            –ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Ü–∏–æ–Ω–æ–≤
        </h1>
        <p class="page-subtitle">
            –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ, —É–ø—Ä–∞–≤–ª—è–π—Ç–µ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–∞—Ü–∏–æ–Ω—ã –¥–ª—è –≤–∞—à–∏—Ö –ª–æ—à–∞–¥–µ–π
        </p>
    </div>

    <div class="actions-bar">
        <div class="filters">
            <select class="filter-select" id="animalFilter">
                <option value="">–í—Å–µ –ª–æ—à–∞–¥–∏</option>
                {% for animal in animals %}
                <option value="{{ animal.animal_id }}">{{ animal.name }}</option>
                {% endfor %}
            </select>
            
            <select class="filter-select" id="dateFilter">
                <option value="">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
                <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
                <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
                <option value="3month">–ó–∞ 3 –º–µ—Å—è—Ü–∞</option>
                <option value="year">–ó–∞ –≥–æ–¥</option>
            </select>
            
            <select class="filter-select" id="sortFilter">
                <option value="newest">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                <option value="oldest">–°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ</option>
                <option value="cost_high">–ü–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (–¥–æ—Ä–æ–≥–∏–µ)</option>
                <option value="cost_low">–ü–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (–¥–µ—à–µ–≤—ã–µ)</option>
            </select>
        </div>
        
        <a href="/ration/" class="action-button">
            <span>‚ûï</span>
            –ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç
        </a>
    </div>

    {% if rations %}
    <div class="ration-grid" id="rationList">
        {% for ration in rations %}
        <div class="ration-card" data-animal-id="{{ ration.animal.animal_id }}" 
             data-date="{{ ration.calculation_date|date:'Y-m-d' }}"
             data-cost="{{ ration.composition.total_month_cost|default:0 }}">
            <div class="ration-header">
                <div>
                    <div class="ration-title">{{ ration.animal.name }}</div>
                    <div class="ration-date">{{ ration.calculation_date|date:'d.m.Y H:i' }}</div>
                </div>
                <span class="ration-badge badge-active">
                    –ê–∫—Ç–∏–≤–Ω—ã–π
                </span>
            </div>
            
            <div class="ration-content">
                <div class="ration-stats">
                    <div class="stat-item">
                        <span class="stat-label">–í–µ—Å –ª–æ—à–∞–¥–∏</span>
                        <span class="stat-value">{{ ration.animal.estimated_weight|default:"?" }} –∫–≥</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">–°—É—Ö–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞</span>
                        <span class="stat-value">{{ ration.total_dmi|default:"0" }} –∫–≥/–¥–µ–Ω—å</span>
                    </div>
                </div>
                
                {% if ration.composition %}
                <div class="feed-summary">
                    <div class="feed-item">
                        <span class="feed-name">–°–µ–Ω–æ:</span>
                        <span class="feed-amount">{{ ration.composition.hay_amount|default:"0" }} –∫–≥/–¥–µ–Ω—å</span>
                    </div>
                    <div class="feed-item">
                        <span class="feed-name">–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç—ã:</span>
                        <span class="feed-amount">{{ ration.composition.grain_amount|default:"0" }} –∫–≥/–¥–µ–Ω—å</span>
                    </div>
                    <div class="feed-item">
                        <span class="feed-name">–î–æ–±–∞–≤–∫–∏:</span>
                        <span class="feed-amount">{{ ration.composition.supplement_amount|default:"0" }} –∫–≥/–¥–µ–Ω—å</span>
                    </div>
                </div>
                
                <div class="ration-cost">
                    <div class="cost-row">
                        <span class="cost-label">–°—Ç–æ–∏–º–æ—Å—Ç—å –≤ –¥–µ–Ω—å:</span>
                        <span class="cost-value">{{ ration.composition.total_day_cost|default:"0" }} —Ä—É–±</span>
                    </div>
                    <div class="cost-row cost-total">
                        <span class="cost-label">–°—Ç–æ–∏–º–æ—Å—Ç—å –≤ –º–µ—Å—è—Ü:</span>
                        <span class="cost-value">{{ ration.composition.total_month_cost|default:"0" }} —Ä—É–±</span>
                    </div>
                </div>
                {% endif %}
                
                {% if ration.composition.lameness %}
                <div style="background: rgba(59, 130, 246, 0.1); border-radius: var(--radius); padding: 10px; margin-top: 10px; font-size: 12px; color: var(--text-primary);">
                    <span style="font-weight: 600;">–•—Ä–æ–º–æ—Ç–∞:</span> {{ ration.composition.lameness|title }}
                </div>
                {% endif %}
            </div>
            
            <div class="ration-actions">
                <a href="/ration/{{ ration.ration_id }}/" class="btn btn-view">
                    <span>üëÅÔ∏è</span>
                    –ü—Ä–æ—Å–º–æ—Ç—Ä
                </a>
                <button class="btn btn-delete" onclick="deleteRation({{ ration.ration_id }}, this)">
                    <span>üóëÔ∏è</span>
                    –£–¥–∞–ª–∏—Ç—å
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="pagination">
        <button class="page-btn" id="prevPage" disabled>
            ‚Üê –ù–∞–∑–∞–¥
        </button>
        <span class="page-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ <span id="currentPage">1</span> –∏–∑ <span id="totalPages">1</span></span>
        <button class="page-btn" id="nextPage" disabled>
            –í–ø–µ—Ä–µ–¥ ‚Üí
        </button>
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-icon">ü•ó</div>
        <h2 class="empty-title">–†–∞—Ü–∏–æ–Ω—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h2>
        <p class="empty-text">
            –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–∞—Ü–∏–æ–Ω–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —Ä–∞—Ü–∏–æ–Ω –¥–ª—è –≤–∞—à–µ–π –ª–æ—à–∞–¥–∏.
        </p>
        <a href="/ration/" class="action-button" style="display: inline-flex; max-width: 300px; margin: 0 auto;">
            <span>ü•ï</span>
            –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π —Ä–∞—Ü–∏–æ–Ω
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
    initFilters();
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
    initPagination();
});

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞—Ü–∏–æ–Ω–æ–≤
function initFilters() {
    const animalFilter = document.getElementById('animalFilter');
    const dateFilter = document.getElementById('dateFilter');
    const sortFilter = document.getElementById('sortFilter');
    const rationCards = document.querySelectorAll('.ration-card');
    
    function applyFilters() {
        const selectedAnimal = animalFilter.value;
        const selectedDate = dateFilter.value;
        const selectedSort = sortFilter.value;
        
        let visibleCards = [];
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
        rationCards.forEach(card => {
            let show = true;
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –ª–æ—à–∞–¥–∏
            if (selectedAnimal && card.dataset.animalId !== selectedAnimal) {
                show = false;
            }
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –¥–∞—Ç–µ
            if (selectedDate && show) {
                const cardDate = new Date(card.dataset.date);
                const now = new Date();
                let cutoffDate = new Date();
                
                switch(selectedDate) {
                    case 'week':
                        cutoffDate.setDate(now.getDate() - 7);
                        break;
                    case 'month':
                        cutoffDate.setMonth(now.getMonth() - 1);
                        break;
                    case '3month':
                        cutoffDate.setMonth(now.getMonth() - 3);
                        break;
                    case 'year':
                        cutoffDate.setFullYear(now.getFullYear() - 1);
                        break;
                }
                
                if (cardDate < cutoffDate) {
                    show = false;
                }
            }
            
            if (show) {
                visibleCards.push(card);
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
        
        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
        visibleCards.sort((a, b) => {
            switch(selectedSort) {
                case 'newest':
                    return new Date(b.dataset.date) - new Date(a.dataset.date);
                case 'oldest':
                    return new Date(a.dataset.date) - new Date(b.dataset.date);
                case 'cost_high':
                    return parseFloat(b.dataset.cost) - parseFloat(a.dataset.cost);
                case 'cost_low':
                    return parseFloat(a.dataset.cost) - parseFloat(b.dataset.cost);
                default:
                    return 0;
            }
        });
        
        // –ü–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
        const rationList = document.getElementById('rationList');
        visibleCards.forEach(card => {
            rationList.appendChild(card);
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
        updatePagination(visibleCards.length);
    }
    
    // –°–ª—É—à–∞—Ç–µ–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ñ–∏–ª—å—Ç—Ä–æ–≤
    animalFilter.addEventListener('change', applyFilters);
    dateFilter.addEventListener('change', applyFilters);
    sortFilter.addEventListener('change', applyFilters);
}

// –ü–∞–≥–∏–Ω–∞—Ü–∏—è
function initPagination() {
    const cardsPerPage = 6;
    let currentPage = 1;
    
    function updatePagination(totalVisible) {
        const totalPages = Math.ceil(totalVisible / cardsPerPage);
        const currentPageEl = document.getElementById('currentPage');
        const totalPagesEl = document.getElementById('totalPages');
        const prevBtn = document.getElementById('prevPage');
        const nextBtn = document.getElementById('nextPage');
        
        currentPageEl.textContent = currentPage;
        totalPagesEl.textContent = totalPages;
        
        prevBtn.disabled = currentPage === 1;
        nextBtn.disabled = currentPage === totalPages;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        const allCards = document.querySelectorAll('.ration-card');
        let startIndex = (currentPage - 1) * cardsPerPage;
        let endIndex = startIndex + cardsPerPage;
        
        allCards.forEach((card, index) => {
            if (index >= startIndex && index < endIndex && card.style.display !== 'none') {
                card.style.display = 'block';
            } else if (card.style.display !== 'none') {
                card.style.display = 'none';
            }
        });
    }
    
    document.getElementById('prevPage').addEventListener('click', function() {
        if (currentPage > 1) {
            currentPage--;
            updatePagination(document.querySelectorAll('.ration-card[style*="block"]').length);
        }
    });
    
    document.getElementById('nextPage').addEventListener('click', function() {
        const totalVisible = document.querySelectorAll('.ration-card[style*="block"]').length;
        const totalPages = Math.ceil(totalVisible / cardsPerPage);
        
        if (currentPage < totalPages) {
            currentPage++;
            updatePagination(totalVisible);
        }
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    window.updatePagination = updatePagination;
}

// –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞—Ü–∏–æ–Ω–∞
function deleteRation(rationId, button) {
    if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–∞—Ü–∏–æ–Ω?\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
        return;
    }
    
    const card = button.closest('.ration-card');
    card.style.opacity = '0.5';
    card.style.pointerEvents = 'none';
    
    fetch(`/api/rations/${rationId}/`, {
        method: 'DELETE',
        headers: {
            'X-CSRFToken': getCookie('csrftoken')
        }
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        if (data.success) {
            // –ê–Ω–∏–º–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è
            card.style.transition = 'all 0.3s ease';
            card.style.transform = 'scale(0.8)';
            card.style.opacity = '0';
            
            setTimeout(() => {
                card.remove();
                showNotification('‚úÖ –†–∞—Ü–∏–æ–Ω —É–¥–∞–ª–µ–Ω', 'success');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –µ—â–µ —Ä–∞—Ü–∏–æ–Ω—ã
                const remainingCards = document.querySelectorAll('.ration-card');
                if (remainingCards.length === 0) {
                    location.reload(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–ª—è –ø–æ–∫–∞–∑–∞ empty-state
                }
            }, 300);
        } else {
            throw new Error(data.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
        }
    })
    .catch(error => {
        console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
        card.style.opacity = '1';
        card.style.pointerEvents = 'auto';
        showNotification(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
    });
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function showNotification(message, type = 'info') {
    // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 20px;
        background: ${type === 'success' ? 'rgba(16, 185, 129, 0.9)' : 'rgba(239, 68, 68, 0.9)'};
        color: white;
        border-radius: var(--radius);
        z-index: 1000;
        animation: slideIn 0.3s ease;
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

// –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏
const style = document.createElement('style');
style.textContent = `
    @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}
