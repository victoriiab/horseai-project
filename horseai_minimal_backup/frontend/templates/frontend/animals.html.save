{% extends 'frontend/base.html' %}

{% block title %}–ú–æ–∏ –ª–æ—à–∞–¥–∏ - HorseAI{% endblock %}

{% block extra_css %}
<style>
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 1px solid var(--border);
    }

    .page-title {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .page-title::before {
        content: 'üê¥';
        font-size: 36px;
    }

    .btn-add {
        padding: 12px 24px;
        background: linear-gradient(135deg, var(--sage), #4d7c0f);
        color: white;
        border: none;
        border-radius: var(--radius);
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
    }

    .btn-add:hover {
        background: linear-gradient(135deg, #84cc16, var(--sage));
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
    }

    .animals-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 25px;
        margin-bottom: 40px;
    }

    .animal-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius-lg);
        padding: 25px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .animal-card:hover {
        border-color: var(--accent);
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg), var(--glow);
    }

    .animal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
    }

    .animal-name {
        font-size: 22px;
        font-weight: 700;
        color: var(--text-primary);
    }

    .animal-badge {
        padding: 4px 12px;
        background: rgba(217, 119, 6, 0.2);
        color: var(--accent);
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }

    .animal-details {
        margin-top: 20px;
    }

    .detail-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .detail-label {
        color: var(--text-secondary);
        font-size: 14px;
    }

    .detail-value {
        color: var(--text-primary);
        font-weight: 500;
        font-size: 15px;
    }

    .animal-actions {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    .btn-action {
        flex: 1;
        padding: 10px;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        background: var(--bg-hover);
        color: var(--text-primary);
        font-size: 13px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        transition: all 0.3s ease;
    }

    .btn-action:hover {
        border-color: var(--accent);
        background: var(--bg-card);
    }

    .btn-danger {
        background: rgba(239, 68, 68, 0.1);
        border-color: rgba(239, 68, 68, 0.3);
        color: #fca5a5;
    }

    .btn-danger:hover {
        background: rgba(239, 68, 68, 0.2);
        border-color: #ef4444;
    }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        backdrop-filter: blur(5px);
    }

    .modal-content {
        background: var(--bg-card);
        border-radius: var(--radius-lg);
        padding: 30px;
        width: 90%;
        max-width: 500px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow-lg);
        animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 1px solid var(--border);
    }

    .modal-title {
        font-size: 24px;
        font-weight: 700;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .modal-close {
        background: none;
        border: none;
        color: var(--text-secondary);
        font-size: 24px;
        cursor: pointer;
        padding: 5px;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
    }

    .modal-close:hover {
        background: var(--bg-hover);
        color: var(--text-primary);
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-label {
        display: block;
        color: var(--text-secondary);
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 8px;
    }

    .form-input, .form-select {
        width: 100%;
        padding: 12px 16px;
        background: var(--bg-dark);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        color: var(--text-primary);
        font-size: 15px;
        transition: all 0.3s ease;
    }

    .form-input:focus, .form-select:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow: var(--glow);
    }

    .modal-actions {
        display: flex;
        gap: 12px;
        margin-top: 30px;
    }

    .modal-btn {
        flex: 1;
        padding: 14px;
        border: none;
        border-radius: var(--radius);
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .modal-btn-primary {
        background: linear-gradient(135deg, var(--accent), var(--earth));
        color: white;
    }

    .modal-btn-primary:hover {
        background: linear-gradient(135deg, var(--accent-hover), var(--accent));
        transform: translateY(-2px);
    }

    .modal-btn-secondary {
        background: var(--bg-hover);
        color: var(--text-primary);
        border: 1px solid var(--border);
    }

    .modal-btn-secondary:hover {
        background: var(--border);
        border-color: var(--accent);
    }

    /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
    .empty-state {
        text-align: center;
        padding: 60px 20px;
        background: var(--bg-card);
        border-radius: var(--radius-lg);
        border: 2px dashed var(--border);
    }

    .empty-icon {
        font-size: 64px;
        margin-bottom: 20px;
        opacity: 0.5;
    }

    .empty-title {
        font-size: 22px;
        font-weight: 600;
        color: var(--text-secondary);
        margin-bottom: 10px;
    }

    .empty-description {
        color: var(--text-tertiary);
        font-size: 15px;
        max-width: 400px;
        margin: 0 auto 25px;
    }
</style>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">–ú–æ–∏ –ª–æ—à–∞–¥–∏</h1>
    <button id="addAnimalBtn" class="btn-add">
        <span>‚ûï</span>
        –î–æ–±–∞–≤–∏—Ç—å –ª–æ—à–∞–¥—å
    </button>
</div>

{% if animals %}
    <div class="animals-grid">
        {% for animal in animals %}
        <div class="animal-card" data-animal-id="{{ animal.animal_id }}">
            <div class="animal-header">
                <h3 class="animal-name">{{ animal.name|default:"–ë–µ–∑ –∏–º–µ–Ω–∏" }}</h3>
                {% if animal.sex %}
                <span class="animal-badge">
                    {% if animal.sex == 'male' %}‚ôÇÔ∏è –ñ–µ—Ä–µ–±–µ—Ü
                    {% elif animal.sex == 'female' %}‚ôÄÔ∏è –ö–æ–±—ã–ª–∞
                
                    {% endif %}
                </span>
                {% endif %}
            </div>

            <div class="animal-details">
                {% if animal.age %}
                <div class="detail-row">
                    <span class="detail-label">–í–æ–∑—Ä–∞—Å—Ç:</span>
                    <span class="detail-value">{{ animal.age }} –ª–µ—Ç</span>
                </div>
                {% endif %}

                {% if animal.estimated_weight %}
                <div class="detail-row">
                    <span class="detail-label">–í–µ—Å:</span>
                    <span class="detail-value">{{ animal.estimated_weight }} –∫–≥</span>
                </div>
                {% endif %}

                <div class="detail-row">
                    <span class="detail-label">–î–æ–±–∞–≤–ª–µ–Ω:</span>
                    <span class="detail-value">{{ animal.created_at|date:"d.m.Y" }}</span>
                </div>
            </div>

            <div class="animal-actions">
                <button class="btn-action" onclick="editAnimal({{ animal.animal_id }})">
                    <span>‚úèÔ∏è</span> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button class="btn-action btn-danger" onclick="deleteAnimal({{ animal.animal_id }})">
                    <span>üóëÔ∏è</span> –£–¥–∞–ª–∏—Ç—å
                </button>
            </div>
        </div>
        {% endfor %}
    </div>
{% else %}
    <div class="empty-state">
        <div class="empty-icon">üê¥</div>
        <h3 class="empty-title">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ª–æ—à–∞–¥–µ–π</h3>
        <p class="empty-description">
            –î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –ª–æ—à–∞–¥—å –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–æ–π.
            –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤–∏–¥–µ–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ.
        </p>
        <button id="addAnimalEmptyBtn" class="btn-add">
            <span>‚ûï</span>
            –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é –ª–æ—à–∞–¥—å
        </button>
    </div>
{% endif %}

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
<div id="animalModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">
                <span>üê¥</span>
                <span id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –ª–æ—à–∞–¥—å</span>
            </h2>
            <button class="modal-close" onclick="closeModal()">√ó</button>
        </div>

        <form id="animalForm">
            {% csrf_token %}
            <input type="hidden" id="animalId" name="animal_id">
            
            <div class="form-group">
                <label class="form-label">–ò–º—è –ª–æ—à–∞–¥–∏ *</label>
                <input type="text" id="animalName" name="name" class="form-input" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ë—É—Ä–∞–Ω" required>
            </div>

            <div class="form-group">
                <label class="form-label">–ü–æ–ª</label>
                <select id="animalSex" name="sex" class="form-select">
                    <option value="">–ù–µ —É–∫–∞–∑–∞–Ω</option>
                    <option value="male">‚ôÇÔ∏è –ñ–µ—Ä–µ–±–µ—Ü</option>
                    <option value="female">‚ôÄÔ∏è –ö–æ–±—ã–ª–∞</option>
                    <option value="gelding">üê¥ –ú–µ—Ä–∏–Ω</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">–í–æ–∑—Ä–∞—Å—Ç (–ª–µ—Ç)</label>
                <input type="number" id="animalAge" name="age" class="form-input" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5" min="0" max="40">
            </div>

            <div class="form-group">
                <label class="form-label">–í–µ—Å (–∫–≥)</label>
                <input type="number" id="animalWeight" name="weight" class="form-input" 
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 450" min="100" max="1000" step="0.1">
            </div>


            <div class="modal-actions">
                <button type="button" class="modal-btn modal-btn-secondary" onclick="closeModal()">
                    –û—Ç–º–µ–Ω–∞
                </button>
                <button type="submit" class="modal-btn modal-btn-primary" id="modalSubmitBtn">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
let currentAnimalId = null;
const modal = document.getElementById('animalModal');
const form = document.getElementById('animalForm');
const modalTitle = document.getElementById('modalTitle');
const submitBtn = document.getElementById('modalSubmitBtn');

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
document.getElementById('addAnimalBtn')?.addEventListener('click', () => openModal());
document.getElementById('addAnimalEmptyBtn')?.addEventListener('click', () => openModal());

// –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function openModal(animalId = null) {
    currentAnimalId = animalId;
    
    if (animalId) {
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        modalTitle.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ—à–∞–¥—å';
        submitBtn.textContent = '–û–±–Ω–æ–≤–∏—Ç—å';
        loadAnimalData(animalId);
    } else {
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ - –æ—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
        modalTitle.textContent = '–î–æ–±–∞–≤–∏—Ç—å –ª–æ—à–∞–¥—å';
        submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
        form.reset();
        document.getElementById('animalId').value = '';
    }
    
    modal.style.display = 'flex';
}

function closeModal() {
    modal.style.display = 'none';
    form.reset();
    currentAnimalId = null;
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
function loadAnimalData(animalId) {
    fetch(`/api/animals/${animalId}/`)
        .then(response => response.json())
        .then(data => {
            document.getElementById('animalId').value = data.animal_id;
            document.getElementById('animalName').value = data.name || '';
            document.getElementById('animalSex').value = data.sex || '';
            document.getElementById('animalAge').value = data.age || '';
            document.getElementById('animalWeight').value = data.estimated_weight || '';
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
            alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ª–æ—à–∞–¥–∏');
        });
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData);
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!data.name.trim()) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –ª–æ—à–∞–¥–∏');
        return;
    }
    
    const url = currentAnimalId ? `/api/animals/${currentAnimalId}/update/` : '/api/animals/add/';
// –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData);
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!data.name.trim()) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –ª–æ—à–∞–¥–∏');
        return;
    }
    
    const url = '/api/animals/add/';
    
    submitBtn.disabled = true;
    submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
    
    console.log('üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', data);
    
    fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify({
            name: data.name,
            sex: data.sex,
            age: data.age ? parseInt(data.age) : null,
            weight: data.weight ? parseFloat(data.weight) : null,
        })
    })
    .then(response => {
        console.log('üì• –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:', response.status, response.statusText);
        return response.json().then(data => {
            return {
                data: data,
                ok: response.ok,
                status: response.status
            };
        });
    })
    .then(({data, ok, status}) => {
        console.log('‚úÖ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', data);
        
        if (ok && data.success) {
            alert('üéâ –õ–æ—à–∞–¥—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
            closeModal();
            // –ú–∞–ª–µ–Ω—å–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
            setTimeout(() => {
                location.reload();
            }, 500);
        } else {
            alert('‚ùå –û—à–∏–±–∫–∞: ' + (data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
            console.error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:', data);
        }
    })
    .catch(error => {
        console.error('üö® –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:', error);
        alert('‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12).');
    })
    .finally(() => {
        submitBtn.disabled = false;
        submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
    });
});    const method = currentAnimalId ? 'PUT' : 'POST';
    
    submitBtn.disabled = true;
    submitBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
    
    fetch(url, {
        method: method,
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        if (result.success) {
            alert(currentAnimalId ? '–õ–æ—à–∞–¥—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞!' : '–õ–æ—à–∞–¥—å –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
            closeModal();
            location.reload(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
        } else {
            alert('–û—à–∏–±–∫–∞: ' + (result.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
        }
    })
    .catch(error => {
        console.error('–û—à–∏–±–∫–∞:', error);
        alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
    })
    .finally(() => {
        submitBtn.disabled = false;
        submitBtn.textContent = currentAnimalId ? '–û–±–Ω–æ–≤–∏—Ç—å' : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
    });
});

// –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
function editAnimal(animalId) {
    openModal(animalId);
}

// –£–¥–∞–ª–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
function deleteAnimal(animalId) {
    if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –ª–æ—à–∞–¥—å? –í—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ –∏ –∞–Ω–∞–ª–∏–∑—ã —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.')) {
        return;
    }
    
    fetch(`/api/animals/${animalId}/delete/`, {
        method: 'DELETE',
        headers: {
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        }
    })
    .then(response => response.json())
    .then(result => {
        if (result.success) {
            alert('–õ–æ—à–∞–¥—å —É–¥–∞–ª–µ–Ω–∞');
            location.reload();
        } else {
            alert('–û—à–∏–±–∫–∞: ' + (result.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å'));
        }
    })
    .catch(error => {
        console.error('–û—à–∏–±–∫–∞:', error);
        alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
    });
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ–≥–æ
modal.addEventListener('click', function(e) {
    if (e.target === modal) {
        closeModal();
    }
});
</script>
{% endblock %}
