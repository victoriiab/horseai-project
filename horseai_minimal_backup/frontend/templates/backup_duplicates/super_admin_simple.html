{% extends 'frontend/base.html' %}

{% block title %}SUPER Admin | HorseAI{% endblock %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
.card { border-radius: 10px; margin-bottom: 20px; }
.badge { font-size: 0.8em; padding: 5px 10px; }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <h1 class="mb-4"><i class="fas fa-crown text-warning"></i> SUPER Admin Panel</h1>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card border-left-primary">
                <div class="card-body">
                    <h5><i class="fas fa-users"></i> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h5>
                    <h2 id="users-count">8</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-left-success">
                <div class="card-body">
                    <h5><i class="fas fa-horse"></i> –ñ–∏–≤–æ—Ç–Ω—ã–µ</h5>
                    <h2 id="animals-count">12</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-left-info">
                <div class="card-body">
                    <h5><i class="fas fa-chart-line"></i> –ê–Ω–∞–ª–∏–∑—ã</h5>
                    <h2 id="analyses-count">19</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-left-warning">
                <div class="card-body">
                    <h5><i class="fas fa-exclamation-triangle"></i> –•—Ä–æ–º–æ—Ç–∞</h5>
                    <h2 id="lame-count">3</h2>
                </div>
            </div>
        </div>
    </div>
    
    <button class="btn btn-primary mb-4" onclick="updateStats()">
        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
    </button>
    
    <div class="alert alert-info">
        <i class="fas fa-info-circle"></i> –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –¶–∏—Ñ—Ä—ã –≤—ã—à–µ - —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
function updateStats() {
    console.log("üîÑ –û–±–Ω–æ–≤–ª—è—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É...");
    
    fetch('/api/system-stats/')
        .then(r => r.json())
        .then(data => {
            console.log("üìä –ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ:", data);
            
            if (data.status === 'success') {
                document.getElementById('users-count').textContent = data.users_count;
                document.getElementById('animals-count').textContent = data.animals_count;
                document.getElementById('analyses-count').textContent = data.analyses_count;
                document.getElementById('lame-count').textContent = data.lame_count;
                console.log("‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!");
            }
        })
        .catch(error => {
            console.error("‚ùå –û—à–∏–±–∫–∞:", error);
        });
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    console.log("üöÄ SUPER Admin –∑–∞–≥—Ä—É–∂–µ–Ω–∞");
    updateStats(); // –°—Ä–∞–∑—É –æ–±–Ω–æ–≤–ª—è–µ–º
});
</script>
{% endblock %}
