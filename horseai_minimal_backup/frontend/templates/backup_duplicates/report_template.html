<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç—á–µ—Ç HorseAI - {{ animal.name|default:"–õ–æ—à–∞–¥—å" }}</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #4CAF50;
        }
        
        .logo {
            font-size: 32px;
            font-weight: bold;
            color: #2E7D32;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 18px;
        }
        
        .report-info {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .section {
            background-color: #fff;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .section-title {
            color: #2E7D32;
            font-size: 22px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .animal-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .info-item {
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }
        
        .info-label {
            font-weight: 600;
            color: #555;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 18px;
            color: #333;
            font-weight: 500;
        }
        
        .status-card {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        
        .status-healthy {
            background-color: #e8f5e9;
            border: 2px solid #4CAF50;
        }
        
        .status-suspected {
            background-color: #fff3e0;
            border: 2px solid #ff9800;
        }
        
        .status-lame {
            background-color: #ffebee;
            border: 2px solid #f44336;
        }
        
        .ration-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .ration-table th {
            background-color: #2E7D32;
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .ration-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #ddd;
        }
        
        .ration-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .total-row {
            font-weight: bold;
            background-color: #e8f5e9;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #777;
            font-size: 14px;
        }
        
        .disclaimer {
            background-color: #fff3e0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ff9800;
            margin-top: 30px;
            font-size: 14px;
        }
        
        @media print {
            body {
                background-color: white;
            }
            .section {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">HorseAI</div>
        <div class="subtitle">–û—Ç—á–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ª–æ—à–∞–¥–∏</div>
        <div style="margin-top: 10px; color: #666;">
            –î–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è: {{ report_date }}
        </div>
    </div>
    
    <div class="report-info">
        <h2 style="color: #2E7D32; margin-top: 0;">–ö–∞—Ä—Ç–æ—á–∫–∞ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ</h2>
        <div class="animal-info-grid">
            <div class="info-item">
                <div class="info-label">–ö–ª–∏—á–∫–∞</div>
                <div class="info-value">{{ animal.name|default:"–ù–µ —É–∫–∞–∑–∞–Ω–∞" }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">–ü–æ–ª</div>
                <div class="info-value">{{ animal.sex|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">–í–æ–∑—Ä–∞—Å—Ç</div>
                <div class="info-value">
                    {% if animal.age %}
                        {{ animal.age }} –ª–µ—Ç
                    {% else %}
                        –ù–µ —É–∫–∞–∑–∞–Ω
                    {% endif %}
                </div>
            </div>
            <div class="info-item">
                <div class="info-label">–í–µ—Å</div>
                <div class="info-value">
                    {% if animal.estimated_weight %}
                        {{ animal.estimated_weight }} –∫–≥
                    {% else %}
                        –ù–µ —É–∫–∞–∑–∞–Ω
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    {% if analysis %}
    <div class="section">
        <h2 class="section-title">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Ö–æ–¥–∫–∏</h2>
        
        <div class="status-card 
            {% if analysis.is_lame == False %}status-healthy
            {% elif analysis.is_lame == True %}status-lame
            {% else %}status-suspected{% endif %}">
            
            <h3 style="margin-top: 0;">
                {% if analysis.is_lame == False %}
                    üü¢ –õ–æ—à–∞–¥—å –∑–¥–æ—Ä–æ–≤–∞
                {% elif analysis.is_lame == True %}
                    üî¥ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ö—Ä–æ–º–æ—Ç–∞
                {% else %}
                    üü° –ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ —Ö—Ä–æ–º–æ—Ç—É
                {% endif %}
            </h3>
            
            {% if analysis.lameness_probability %}
                <p>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ö—Ä–æ–º–æ—Ç—ã: <strong>{{ analysis.lameness_probability|floatformat:1 }}%</strong></p>
            {% endif %}
            
            {% if analysis.confidence_score %}
                <p>–î–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞: <strong>{{ analysis.confidence_score|floatformat:1 }}%</strong></p>
            {% endif %}
            
            {% if analysis.diagnosis %}
                <div style="margin-top: 15px; text-align: left;">
                    <strong>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</strong>
                    <p>{{ analysis.diagnosis }}</p>
                </div>
            {% endif %}
            
            {% if analysis.diagnosis_note %}
                <div style="margin-top: 10px; text-align: left;">
                    <strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong>
                    <p>{{ analysis.diagnosis_note }}</p>
                </div>
            {% endif %}
        </div>
        
        {% if analysis.analysis_date %}
            <p><strong>–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:</strong> {{ analysis.analysis_date|date:"d.m.Y H:i" }}</p>
        {% endif %}
    </div>
    {% endif %}
    
    {% if ration %}
    <div class="section">
        <h2 class="section-title">ü•ï –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞—Ü–∏–æ–Ω –∫–æ—Ä–º–ª–µ–Ω–∏—è</h2>
        
        <p><strong>–î–∞—Ç–∞ —Ä–∞—Å—á–µ—Ç–∞:</strong> {{ ration.calculation_date|date:"d.m.Y H:i"|default:"–ù–µ —É–∫–∞–∑–∞–Ω–∞" }}</p>
        
        {% if ration.total_dmi %}
            <p><strong>–û–±—â–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Å—É—Ö–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞:</strong> {{ ration.total_dmi|floatformat:2 }} –∫–≥/–¥–µ–Ω—å</p>
        {% endif %}
        
        {% if ration.energy_content %}
            <p><strong>–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å:</strong> {{ ration.energy_content|floatformat:0 }} –∫–∫–∞–ª/–¥–µ–Ω—å</p>
        {% endif %}
        
        {% if composition %}
            <table class="ration-table">
                <thead>
                    <tr>
                        <th>–ö–æ—Ä–º</th>
                        <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (–∫–≥/–¥–µ–Ω—å)</th>
                        <th>–¢–∏–ø</th>
                        <th>–≠–Ω–µ—Ä–≥–∏—è (–∫–∫–∞–ª/–∫–≥)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in composition.values %}
                    <tr>
                        <td>{{ item.name|default:"–ù–µ —É–∫–∞–∑–∞–Ω" }}</td>
                        <td>{{ item.quantity|floatformat:2|default:"0.00" }}</td>
                        <td>{{ item.type|default:"-" }}</td>
                        <td>{{ item.energy|floatformat:0|default:"0" }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 20px;">
                            –°–æ—Å—Ç–∞–≤ —Ä–∞—Ü–∏–æ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω
                        </td>
                    </tr>
                    {% endfor %}
                    
                    {% if ration.total_dmi %}
                    <tr class="total-row">
                        <td><strong>–ò—Ç–æ–≥–æ</strong></td>
                        <td><strong>{{ ration.total_dmi|floatformat:2 }} –∫–≥</strong></td>
                        <td></td>
                        <td><strong>{{ ration.energy_content|floatformat:0|default:"0" }} –∫–∫–∞–ª</strong></td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        {% endif %}
        
        {% if ration.composition and not composition %}
            <p><strong>–°–æ—Å—Ç–∞–≤ —Ä–∞—Ü–∏–æ–Ω–∞ (JSON):</strong></p>
            <pre style="background-color: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;">
{{ ration.composition|pprint }}
            </pre>
        {% endif %}
    </div>
    {% endif %}
    
    <div class="disclaimer">
        <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong>
        <p>–î–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –Ω–æ—Å–∏—Ç —Å–ø—Ä–∞–≤–æ—á–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏. 
        –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞—Ü–∏–æ–Ω—É —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ 
        –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º.</p>
        <p>–°–∏—Å—Ç–µ–º–∞ HorseAI –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —É—á–µ–±–Ω—ã—Ö –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π.</p>
    </div>
    
    <div class="footer">
        <p>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å–∏—Å—Ç–µ–º–æ–π {{ system_name }}</p>
        <p>¬© {% now "Y" %} HorseAI. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        <p class="no-print">
            <button onclick="window.print()" style="padding: 10px 20px; background-color: #4CAF50; color: white; 
                   border: none; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                üñ®Ô∏è –ü–µ—á–∞—Ç—å –æ—Ç—á–µ—Ç–∞
            </button>
        </p>
    </div>
</body>
</html>
